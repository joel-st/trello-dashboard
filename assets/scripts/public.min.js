!function(n){var o={};function a(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=n,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=2)}({2:function(t,e,n){"use strict";function o(t,e,n){var o,a="";n&&((o=new Date).setTime("".concat(o.getTime()).concat(n||2592e6)),a='; expiryDate=" '.concat(o.toUTCString())),document.cookie="".concat(t,"=").concat(e||"").concat(a,"; path=/")}n.r(e);var a={get:function(t){return(t=document.cookie.match("(^|[^;]+)\\s*"+t+"\\s*=\\s*([^;]+)"))?t.pop():""},set:o,update:function(){console.log("updateCookie")},remove:function(t){o(t,"",-1)}};var i={initSignup:function(){function e(){console.log(tvpTdVars.i18n.trelloAuthenticationSuccess),location.reload()}function n(){console.log(tvpTdVars.i18n.trelloAuthenticationFailure)}$("#tvptd-signup-with-trello").on("click",function(t){t.preventDefault(),window.Trello.authorize({type:"popup",name:"TVP Trello Dashboard",scope:{read:"true",write:"false",account:"true"},expiration:"never",success:e,error:n})})}};var r={loadOverview:function(){var t=$("#tvptd-organization-overview"),e=$("#tvptd-organization-overview .tvptd__widget-content");t&&$.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-get-organization-overview"},success:function(t){t=JSON.parse(t);e.html(t.html),e.removeClass("tvptd__widget-content--loading")},error:function(t){e.html('<section class="tvptd__widget-section">Oups, something went wrong wile loading the overview.</section>'),e.removeClass("tvptd__widget-content--loading")}})},loadStatistics:function e(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=$("#tvptd-organization-statistics"),o=$("#tvptd-organization-statistics .tvptd__widget-content"),a=$("#tvptd-organization-statistics-timerange");a.attr("initialized")||a.on("change",function(t){a.attr("initialized",!0),a.attr("disabled",!0),e(t.target.value)}),t=t||a.val(),n&&(o.addClass("tvptd__widget-content--loading"),o.html('<div class="tvptd__spinner spinner"></div>'),$.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-get-organization-statistics",timeRange:t},success:function(t){t=JSON.parse(t),o.html(t.html),o.removeClass("tvptd__widget-content--loading"),a.attr("disabled",!1)},error:function(t){o.html('<section class="tvptd__widget-section">Oups, something went wrong wile loading the statistics.</section>'),o.removeClass("tvptd__widget-content--loading"),a.attr("disabled",!1)}}))}};var c={init:function(){var t=$("#tvptd-profile"),e=$("#tvptd-logout");t.on("click",function(){t.toggleClass("active")}),e.on("click",function(){s.logout()})}};var l,s={login:function(t,e){var n=$("#tvptd-loading");$.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-login",nonce:tvpTdVars.nonces.login,member:{id:t.id,email:t.email},membership:e},success:function(t){$.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-get-dashboard-content",nonce:tvpTdVars.nonces.content},success:function(t){t=JSON.parse(t);n.replaceWith(t.html),n.attr("id","tvptd"),c.init(),r.loadOverview(),r.loadStatistics()}})},error:function(t){alert("Oups, sorry, something went wrong. Try it again later.")}})},logout:function(){Trello.deauthorize(),$.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-logout",nonce:tvpTdVars.nonces.logout},success:function(t){location.reload()}})}};(l=jQuery)(function(){var t,e=l("#tvptd-loading");function n(){l.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-get-not-in-organization-content",nonce:tvpTdVars.nonces.signup},success:function(t){t=JSON.parse(t);e.replaceWith(t.html),Trello.deauthorize()}})}e.length&&(t=localStorage.trello_token||!1,a.get(tvpTdVars.authCookie),t?(Trello.setToken(t),Trello.authorized()?Trello.members.get("me",function(e){e.idOrganizations.includes(tvpTdVars.trelloOrganization)?Trello.get("organizations/"+tvpTdVars.trelloOrganization+"/memberships",function(t){t=t.filter(function(t){return t.idMember==e.id}),t=!!t&&t[0];t?s.login(e,t):n()}):n()}):s.logout()):l.ajax({type:"GET",url:tvpTdVars.ajaxUrl,data:{action:"tvptd-public-ajax-get-signup-content",nonce:tvpTdVars.nonces.signup},success:function(t){t=JSON.parse(t);e.replaceWith(t.html),i.initSignup()}}))})}});